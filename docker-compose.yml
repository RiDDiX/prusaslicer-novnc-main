---
# Docker Compose for Nvidia GPU
# For Intel iGPU, use: docker compose -f docker-compose.intel.yml up -d
version: "2.1"
services:
  prusaslicer-novnc:
    image: ghcr.io/${GITHUB_USER:-your-username}/prusaslicer-novnc:latest
    container_name: prusaslicer-novnc
    runtime: nvidia
    environment:
      - SSL_CERT_FILE=/etc/ssl/certs/ca-certificates.crt
      - NVIDIA_VISIBLE_DEVICES=all
      - NVIDIA_DRIVER_CAPABILITIES=all
      - DISPLAY=:0
      - VGL_DISPLAY=egl
      - SUPD_LOGLEVEL=INFO 
      - ENABLEHWGPU=true
      - VNC_RESOLUTION=1920x1080
      # Auto-update settings
      - AUTO_UPDATE=true
      - ENABLE_PERIODIC_UPDATES=false
      - UPDATE_CHECK_INTERVAL=86400
      # AppImage source - leave empty to use community repo (probonopd/PrusaSlicer.AppImage)
      # Set to your own repo if you build AppImages via GitHub Actions
      #- PRUSASLICER_APPIMAGE_REPO=RiDDiX/prusaslicer-appimage
    volumes:
      - ./prints:/prints/
      - ./data:/configs/
    ports:
      - "8080:8080"
      - "5900:5900"
    restart: unless-stopped
