[supervisord]
nodaemon=true
pidfile=/tmp/supervisord.pid

[program:vnc]
priority=0
command=/opt/TurboVNC/bin/vncserver %(ENV_DISPLAY)s -fg  %(ENV_VNC_SEC)s -depth 24 -geometry %(ENV_VNC_RESOLUTION)s -desktop "Prusaslicer"
autorestart=true
redirect_stderr=true

[program:novnc]
priority=0
command=websockify --web=/usr/share/novnc/ %(ENV_NOVNC_PORT)s  localhost:%(ENV_LOCALFBPORT)s
autorestart=true
redirect_stderr=true

[program:prusaslicer]
priority=1
environment=VGL_DISPLAY=%(ENV_VGL_DISPLAY)s,LIBGL_ALWAYS_SOFTWARE=%(ENV_LIBGL_ALWAYS_SOFTWARE)s,MESA_GL_VERSION_OVERRIDE=3.3,GALLIUM_DRIVER=%(ENV_GALLIUM_DRIVER)s
command=/bin/bash -c '%(ENV_VGLRUN)s /slic3r/squashfs-root/AppRun --datadir /configs/.config/PrusaSlicer/'
autorestart=true
redirect_stderr=true
startsecs=5

[program:update-checker]
priority=2
command=/slic3r/periodic_update_check.sh
autostart=%(ENV_ENABLE_PERIODIC_UPDATES)s
autorestart=true
redirect_stderr=true
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
